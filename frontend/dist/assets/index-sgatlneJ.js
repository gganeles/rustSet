(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();const Re=!1,Fe=(e,t)=>e===t,Ve=Symbol("solid-track"),me={equals:Fe};let je=Ue;const q=1,he=2,Ie={owned:null,cleanups:null,context:null,owner:null};var O=null;let Se=null,qe=null,E=null,T=null,R=null,xe=0;function pe(e,t){const n=E,s=O,o=e.length===0,r=t===void 0?s:t,i=o?Ie:{owned:null,cleanups:null,context:r?r.context:null,owner:r},l=o?e:()=>e(()=>ee(()=>se(i)));O=i,E=null;try{return oe(l,!0)}finally{E=n,O=s}}function k(e,t){t=t?Object.assign({},me,t):me;const n={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},s=o=>(typeof o=="function"&&(o=o(n.value)),De(n,o));return[Me.bind(n),s]}function D(e,t,n){const s=Ne(e,t,!1,q);le(s)}function Je(e,t,n){je=Qe;const s=Ne(e,t,!1,q);s.user=!0,R?R.push(s):le(s)}function Te(e,t,n){n=n?Object.assign({},me,n):me;const s=Ne(e,t,!0,0);return s.observers=null,s.observerSlots=null,s.comparator=n.equals||void 0,le(s),Me.bind(s)}function ee(e){if(E===null)return e();const t=E;E=null;try{return e()}finally{E=t}}function _e(e){Je(()=>ee(e))}function ke(e){return O===null||(O.cleanups===null?O.cleanups=[e]:O.cleanups.push(e)),e}function Me(){if(this.sources&&this.state)if(this.state===q)le(this);else{const e=T;T=null,oe(()=>ye(this),!1),T=e}if(E){const e=this.observers?this.observers.length:0;E.sources?(E.sources.push(this),E.sourceSlots.push(e)):(E.sources=[this],E.sourceSlots=[e]),this.observers?(this.observers.push(E),this.observerSlots.push(E.sources.length-1)):(this.observers=[E],this.observerSlots=[E.sources.length-1])}return this.value}function De(e,t,n){let s=e.value;return(!e.comparator||!e.comparator(s,t))&&(e.value=t,e.observers&&e.observers.length&&oe(()=>{for(let o=0;o<e.observers.length;o+=1){const r=e.observers[o],i=Se&&Se.running;i&&Se.disposed.has(r),(i?!r.tState:!r.state)&&(r.pure?T.push(r):R.push(r),r.observers&&Be(r)),i||(r.state=q)}if(T.length>1e6)throw T=[],new Error},!1)),t}function le(e){if(!e.fn)return;se(e);const t=xe;He(e,e.value,t)}function He(e,t,n){let s;const o=O,r=E;E=O=e;try{s=e.fn(t)}catch(i){return e.pure&&(e.state=q,e.owned&&e.owned.forEach(se),e.owned=null),e.updatedAt=n+1,Ge(i)}finally{E=r,O=o}(!e.updatedAt||e.updatedAt<=n)&&(e.updatedAt!=null&&"observers"in e?De(e,s):e.value=s,e.updatedAt=n)}function Ne(e,t,n,s=q,o){const r={fn:e,state:s,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:O,context:O?O.context:null,pure:n};return O===null||O!==Ie&&(O.owned?O.owned.push(r):O.owned=[r]),r}function be(e){if(e.state===0)return;if(e.state===he)return ye(e);if(e.suspense&&ee(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<xe);)e.state&&t.push(e);for(let n=t.length-1;n>=0;n--)if(e=t[n],e.state===q)le(e);else if(e.state===he){const s=T;T=null,oe(()=>ye(e,t[0]),!1),T=s}}function oe(e,t){if(T)return e();let n=!1;t||(T=[]),R?n=!0:R=[],xe++;try{const s=e();return Ke(n),s}catch(s){n||(R=null),T=null,Ge(s)}}function Ke(e){if(T&&(Ue(T),T=null),e)return;const t=R;R=null,t.length&&oe(()=>je(t),!1)}function Ue(e){for(let t=0;t<e.length;t++)be(e[t])}function Qe(e){let t,n=0;for(t=0;t<e.length;t++){const s=e[t];s.user?e[n++]=s:be(s)}for(t=0;t<n;t++)be(e[t])}function ye(e,t){e.state=0;for(let n=0;n<e.sources.length;n+=1){const s=e.sources[n];if(s.sources){const o=s.state;o===q?s!==t&&(!s.updatedAt||s.updatedAt<xe)&&be(s):o===he&&ye(s,t)}}}function Be(e){for(let t=0;t<e.observers.length;t+=1){const n=e.observers[t];n.state||(n.state=he,n.pure?T.push(n):R.push(n),n.observers&&Be(n))}}function se(e){let t;if(e.sources)for(;e.sources.length;){const n=e.sources.pop(),s=e.sourceSlots.pop(),o=n.observers;if(o&&o.length){const r=o.pop(),i=n.observerSlots.pop();s<o.length&&(r.sourceSlots[i]=s,o[s]=r,n.observerSlots[s]=i)}}if(e.tOwned){for(t=e.tOwned.length-1;t>=0;t--)se(e.tOwned[t]);delete e.tOwned}if(e.owned){for(t=e.owned.length-1;t>=0;t--)se(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0}function Xe(e){return e instanceof Error?e:new Error(typeof e=="string"?e:"Unknown error",{cause:e})}function Ge(e,t=O){throw Xe(e)}const Ye=Symbol("fallback");function Oe(e){for(let t=0;t<e.length;t++)e[t]()}function Ze(e,t,n={}){let s=[],o=[],r=[],i=0,l=t.length>1?[]:null;return ke(()=>Oe(r)),()=>{let u=e()||[],c=u.length,b,f;return u[Ve],ee(()=>{let w,L,$,_,h,m,a,p,d;if(c===0)i!==0&&(Oe(r),r=[],s=[],o=[],i=0,l&&(l=[])),n.fallback&&(s=[Ye],o[0]=pe(y=>(r[0]=y,n.fallback())),i=1);else if(i===0){for(o=new Array(c),f=0;f<c;f++)s[f]=u[f],o[f]=pe(N);i=c}else{for($=new Array(c),_=new Array(c),l&&(h=new Array(c)),m=0,a=Math.min(i,c);m<a&&s[m]===u[m];m++);for(a=i-1,p=c-1;a>=m&&p>=m&&s[a]===u[p];a--,p--)$[p]=o[a],_[p]=r[a],l&&(h[p]=l[a]);for(w=new Map,L=new Array(p+1),f=p;f>=m;f--)d=u[f],b=w.get(d),L[f]=b===void 0?-1:b,w.set(d,f);for(b=m;b<=a;b++)d=s[b],f=w.get(d),f!==void 0&&f!==-1?($[f]=o[b],_[f]=r[b],l&&(h[f]=l[b]),f=L[f],w.set(d,f)):r[b]();for(f=m;f<c;f++)f in $?(o[f]=$[f],r[f]=_[f],l&&(l[f]=h[f],l[f](f))):o[f]=pe(N);o=o.slice(0,i=c),s=u.slice(0)}return o});function N(w){if(r[f]=w,l){const[L,$]=k(f);return l[f]=$,t(u[f],L)}return t(u[f])}}}function G(e,t){return ee(()=>e(t||{}))}function ve(e){const t="fallback"in e&&{fallback:()=>e.fallback};return Te(Ze(()=>e.each,e.children,t||void 0))}const J=e=>Te(()=>e());function ze(e,t,n){let s=n.length,o=t.length,r=s,i=0,l=0,u=t[o-1].nextSibling,c=null;for(;i<o||l<r;){if(t[i]===n[l]){i++,l++;continue}for(;t[o-1]===n[r-1];)o--,r--;if(o===i){const b=r<s?l?n[l-1].nextSibling:n[r-l]:u;for(;l<r;)e.insertBefore(n[l++],b)}else if(r===l)for(;i<o;)(!c||!c.has(t[i]))&&t[i].remove(),i++;else if(t[i]===n[r-1]&&n[l]===t[o-1]){const b=t[--o].nextSibling;e.insertBefore(n[l++],t[i++].nextSibling),e.insertBefore(n[--r],b),t[o]=n[r]}else{if(!c){c=new Map;let f=l;for(;f<r;)c.set(n[f],f++)}const b=c.get(t[i]);if(b!=null)if(l<b&&b<r){let f=i,N=1,w;for(;++f<o&&f<r&&!((w=c.get(t[f]))==null||w!==b+N);)N++;if(N>b-l){const L=t[i];for(;l<b;)e.insertBefore(n[l++],L)}else e.replaceChild(n[l++],t[i++])}else i++;else t[i++].remove()}}}const Ae="_$DX_DELEGATE";function et(e,t,n,s={}){let o;return pe(r=>{o=r,t===document?e():v(t,e(),t.firstChild?null:void 0,n)},s.owner),()=>{o(),t.textContent=""}}function S(e,t,n,s){let o;const r=()=>{const l=document.createElement("template");return l.innerHTML=e,l.content.firstChild},i=()=>(o||(o=r())).cloneNode(!0);return i.cloneNode=i,i}function ie(e,t=window.document){const n=t[Ae]||(t[Ae]=new Set);for(let s=0,o=e.length;s<o;s++){const r=e[s];n.has(r)||(n.add(r),t.addEventListener(r,st))}}function re(e,t,n){n==null?e.removeAttribute(t):e.setAttribute(t,n)}function z(e,t){t==null?e.removeAttribute("class"):e.className=t}function tt(e,t,n,s){Array.isArray(n)?(e[`$$${t}`]=n[0],e[`$$${t}Data`]=n[1]):e[`$$${t}`]=n}function Ce(e,t,n){n!=null?e.style.setProperty(t,n):e.style.removeProperty(t)}function nt(e,t,n){return ee(()=>e(t,n))}function v(e,t,n,s){if(n!==void 0&&!s&&(s=[]),typeof t!="function")return $e(e,t,s,n);D(o=>$e(e,t(),o,n),s)}function st(e){let t=e.target;const n=`$$${e.type}`,s=e.target,o=e.currentTarget,r=u=>Object.defineProperty(e,"target",{configurable:!0,value:u}),i=()=>{const u=t[n];if(u&&!t.disabled){const c=t[`${n}Data`];if(c!==void 0?u.call(t,c,e):u.call(t,e),e.cancelBubble)return}return t.host&&typeof t.host!="string"&&!t.host._$host&&t.contains(e.target)&&r(t.host),!0},l=()=>{for(;i()&&(t=t._$host||t.parentNode||t.host););};if(Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return t||document}}),e.composedPath){const u=e.composedPath();r(u[0]);for(let c=0;c<u.length-2&&(t=u[c],!!i());c++){if(t._$host){t=t._$host,l();break}if(t.parentNode===o)break}}else l();r(s)}function $e(e,t,n,s,o){for(;typeof n=="function";)n=n();if(t===n)return n;const r=typeof t,i=s!==void 0;if(e=i&&n[0]&&n[0].parentNode||e,r==="string"||r==="number"){if(r==="number"&&(t=t.toString(),t===n))return n;if(i){let l=n[0];l&&l.nodeType===3?l.data!==t&&(l.data=t):l=document.createTextNode(t),n=Z(e,n,s,l)}else n!==""&&typeof n=="string"?n=e.firstChild.data=t:n=e.textContent=t}else if(t==null||r==="boolean")n=Z(e,n,s);else{if(r==="function")return D(()=>{let l=t();for(;typeof l=="function";)l=l();n=$e(e,l,n,s)}),()=>n;if(Array.isArray(t)){const l=[],u=n&&Array.isArray(n);if(Ee(l,t,n,o))return D(()=>n=$e(e,l,n,s,!0)),()=>n;if(l.length===0){if(n=Z(e,n,s),i)return n}else u?n.length===0?Le(e,l,s):ze(e,n,l):(n&&Z(e),Le(e,l));n=l}else if(t.nodeType){if(Array.isArray(n)){if(i)return n=Z(e,n,s,t);Z(e,n,null,t)}else n==null||n===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);n=t}}return n}function Ee(e,t,n,s){let o=!1;for(let r=0,i=t.length;r<i;r++){let l=t[r],u=n&&n[e.length],c;if(!(l==null||l===!0||l===!1))if((c=typeof l)=="object"&&l.nodeType)e.push(l);else if(Array.isArray(l))o=Ee(e,l,u)||o;else if(c==="function")if(s){for(;typeof l=="function";)l=l();o=Ee(e,Array.isArray(l)?l:[l],Array.isArray(u)?u:[u])||o}else e.push(l),o=!0;else{const b=String(l);u&&u.nodeType===3&&u.data===b?e.push(u):e.push(document.createTextNode(b))}}return o}function Le(e,t,n=null){for(let s=0,o=t.length;s<o;s++)e.insertBefore(t[s],n)}function Z(e,t,n,s){if(n===void 0)return e.textContent="";const o=s||document.createTextNode("");if(t.length){let r=!1;for(let i=t.length-1;i>=0;i--){const l=t[i];if(o!==l){const u=l.parentNode===e;!r&&!i?u?e.replaceChild(o,l):e.insertBefore(o,n):u&&l.remove()}else r=!0}}else e.insertBefore(o,n);return[o]}var rt=S(`<div class="fixed inset-0 bg-black/50 flex items-center justify-center z-50"><div class="bg-white p-5 rounded shadow max-w-lg w-[90%]"><h3 class="text-lg font-medium mb-2">Welcome â€” what's your name?</h3><form><input class="w-full box-border p-2 border rounded"placeholder="Your name"><div class="flex justify-end gap-2 mt-3"><button type=submit class="px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700">Save`),lt=S('<div class="text-red-600 mt-2">');function ot(e){const[t,n]=k(""),[s,o]=k("");_e(()=>{e.prefill&&n(e.prefill)});function r(i){i&&i.preventDefault();const l=t().trim();if(!l){o("Please enter a name");return}o(""),e.onSave&&e.onSave(l)}return(()=>{var i=rt(),l=i.firstChild,u=l.firstChild,c=u.nextSibling,b=c.firstChild,f=b.nextSibling;return c.addEventListener("submit",r),b.$$input=N=>n(N.target.value),v(c,(()=>{var N=J(()=>!!s());return()=>N()&&(()=>{var w=lt();return v(w,s),w})()})(),f),D(()=>b.value=t()),i})()}ie(["input"]);function we(e){window.history.pushState({},"",e);try{window.dispatchEvent(new PopStateEvent("popstate"))}catch{const n=document.createEvent("Event");window.dispatchEvent(n)}}var it=S('<div><form class="flex flex-wrap items-center gap-2 mb-6"><input class="px-3 py-2 border rounded w-48"placeholder="your name"><button type=submit class="px-3 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">Change Name</button><div></div><div></div></form><form class="flex flex-wrap items-center gap-2 mb-6"><input class="px-3 py-2 border rounded flex-1 min-w-[160px]"placeholder="game name"><button type=submit class="px-3 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">Create Game</button><div></div></form><h2 class="text-lg font-medium mb-2">Available games</h2><ul class=space-y-2>'),Pe=S("<span class=text-red-600>"),at=S("<span class=text-green-600>"),ct=S("<li class=text-gray-600>No games"),ft=S('<li class="flex items-center justify-between gap-4 p-3 border rounded"><div class=text-gray-800> <span class="text-sm text-gray-500">â€” by <!> (<!> players)</span></div><div class="flex gap-2"><button class="px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700">Join</button><button class="px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700">Delete');function dt(e){const[t,n]=k([]),[s,o]=k(""),[r,i]=k(""),[l,u]=k(!0),[c,b]=k(""),[f,N]=k(""),[w,L]=k("");let $=null;function _(g){try{const x=JSON.parse(g.data);if(x.kind==="games_list")try{n(JSON.parse(x.data))}catch{}}catch{}}function h(){if($)try{$.close()}catch{}const g=window.location.protocol==="https:"?"wss:":"ws:",x=window.location.hostname||"192.168.50.111",A=`${g}//${x}:3030/lobby`;$=new WebSocket(A),$.addEventListener("message",_),$.addEventListener("open",()=>{const j={kind:"list_games",data:""};$.send(JSON.stringify(j))}),$.addEventListener("error",j=>{console.error("WebSocket error:",j)}),$.addEventListener("close",()=>{console.log("WebSocket closed")})}_e(()=>{try{const g=localStorage.getItem("rs_name");g&&g.length>0?(i(g),u(!1)):u(!0)}catch{u(!0)}h()}),ke(()=>{if($)try{$.close()}catch{}});function m(g){if(g&&g.preventDefault(),!r()||r().trim()===""){b("Please set your name first");return}if(!s()||s().trim()===""){N("Please enter a game name");return}if(!$||$.readyState!==WebSocket.OPEN)return;const x={name:s(),creator:r()};$.send(JSON.stringify({kind:"create_game",data:JSON.stringify(x)})),o(""),N("")}function a(g){const x=(g||"").trim();if(x){try{localStorage.setItem("rs_name",x)}catch{}i(x),u(!1),b(""),L("Name saved"),setTimeout(()=>L(""),3e3)}}function p(g){if($&&$.readyState===WebSocket.OPEN){const x={id:g,player:r()||"anonymous"};$.send(JSON.stringify({kind:"join_game",data:JSON.stringify(x)}))}we(`/game/${g}`),e.onJoin(g)}function d(g){if(!$||$.readyState!==WebSocket.OPEN)return;const x={id:g};$.send(JSON.stringify({kind:"delete_game",data:JSON.stringify(x)}))}function y(g){if(g&&g.preventDefault(),!r().trim()){b("Please enter a name");return}a(r())}return(()=>{var g=it(),x=g.firstChild,A=x.firstChild,j=A.nextSibling,C=j.nextSibling,H=C.nextSibling,W=x.nextSibling,F=W.firstChild,X=F.nextSibling,K=X.nextSibling,ae=W.nextSibling,te=ae.nextSibling;return v(g,(()=>{var M=J(()=>!!l());return()=>M()&&G(ot,{get prefill(){return r()},onSave:a})})(),x),x.addEventListener("submit",y),A.$$input=M=>i(M.target.value),v(C,(()=>{var M=J(()=>!!c());return()=>M()&&(()=>{var P=Pe();return v(P,c),P})()})()),v(H,(()=>{var M=J(()=>!!w());return()=>M()&&(()=>{var P=at();return v(P,w),P})()})()),W.addEventListener("submit",m),F.$$input=M=>o(M.target.value),v(K,(()=>{var M=J(()=>!!f());return()=>M()&&(()=>{var P=Pe();return v(P,f),P})()})()),v(te,(()=>{var M=J(()=>t().length===0);return()=>M()?ct():t().map((P,ce)=>(()=>{var Y=ft(),I=Y.firstChild,B=I.firstChild,U=B.nextSibling,V=U.firstChild,Q=V.nextSibling,ne=Q.nextSibling,fe=ne.nextSibling;fe.nextSibling;var de=I.nextSibling,ue=de.firstChild,ge=ue.nextSibling;return re(Y,"key",ce),v(I,()=>P.name,B),v(U,()=>P.creator,Q),v(U,()=>P.players_online,fe),ue.$$click=()=>p(P.id),ge.$$click=()=>d(P.id),Y})())})()),D(()=>A.value=r()),D(()=>F.value=s()),g})()}ie(["input","click"]);var ut=S('<div class="h-full flex flex-col">'),gt=S('<div class="text-center py-8 text-gray-500">Loading game board...'),pt=S('<div class="flex-1 min-h-0 overflow-auto"><div class="set-game-grid grid gap-1 sm:gap-2 p-2 mx-auto"style="grid-template-columns:repeat(3, 1fr)">'),mt=S('<div class="relative w-full card-container"><div><div class="w-full h-full flex items-center justify-center"><img class="sm:w-3/4 w-full card-container object-contain p-1"><div class="hidden text-xs text-gray-500">â€¦');function ht(e){const t=e.socket||null,n=e.onGameStateUpdate||(()=>{}),[s,o]=k([]),[r,i]=k([]),[l,u]=k(null),c=h=>{const m=["oval","squiggle","diamond"],a=["filled","lines","clear"],p=["red","green","purple"],d=["1","2","3"],y=m[h[0]],g=a[h[1]],x=p[h[2]],A=d[h[3]];return`https://set.gganeles.com/RegCards/${y}_${g}_${x}_${A}.png`},b=h=>{if(!h.board){console.error("No board data found in game data");return}const m=h.board.map(a=>a.array);console.log("Rendering board with cards:",m),i(m),L(m),u(h),n(h)},f=h=>{try{const m=JSON.parse(h.data);if(console.log("Received message:",m),m.kind==="init"){const a=JSON.parse(m.data);console.log("Initial game data:",a),b(a)}else if(m.kind==="set_found"){const a=JSON.parse(m.data);console.log("Set found! Updated game data:",a),b(a)}}catch(m){console.error("Error parsing message:",m)}};_e(()=>{t&&t.addEventListener("message",f)});const N=h=>{const m=s();if(m.includes(h))o(m.filter(a=>a!==h));else if(m.length<3){const a=[...m,h];o(a),a.length===3&&$(a)}},w=h=>h[0].map((a,p)=>(h[0][p]+h[1][p]+h[2][p])%3).every(a=>a===0),L=h=>{const m=h.length;for(let a=0;a<m;a++)for(let p=a+1;p<m;p++)for(let d=p+1;d<m;d++)if(w([h[a],h[p],h[d]]))return console.log("Found a set on the board:",a,p,d),!0},$=h=>{if(t&&t.readyState===WebSocket.OPEN){const m=localStorage.getItem("rs_name")||"anonymous";let a=null;if(l()&&l().game_state&&l().game_state.players){const d=l().game_state.players.find(y=>y.name===m);d&&(a=d.id)}const p={kind:"set_attempt",data:h,player_id:a};t.send(JSON.stringify(p)),console.log("Sent set_attempt:",h,"from player:",a),o([])}else console.error("WebSocket is not connected")},_=()=>Math.ceil(r().length/3);return(()=>{var h=ut();return v(h,(()=>{var m=J(()=>r().length===0);return()=>m()?gt():(()=>{var a=pt(),p=a.firstChild;return v(p,G(ve,{get each(){return r()},children:(d,y)=>(()=>{var g=mt(),x=g.firstChild,A=x.firstChild,j=A.firstChild;return x.$$click=()=>N(y()),j.addEventListener("error",C=>{C.target.style.display="none",C.target.nextElementSibling.style.display="block"}),D(C=>{var H=_(),W=` aspect-[3/4] card-container md:max-w-[180px] inset-0 border-2 rounded-[20px] max-w-[180px] mx-auto
                                            shadow-sm flex items-center justify-center cursor-pointer
                                            transition-all p-4
                                            ${s().includes(y())?"bg-blue-200 border-blue-500":"bg-white hover:bg-gray-50 border-gray-200"}`,F=c(d),X=`Card ${y()+1}`,K=_();return H!==C.e&&Ce(g,"--desktop-cols",C.e=H),W!==C.t&&z(x,C.t=W),F!==C.a&&re(j,"src",C.a=F),X!==C.o&&re(j,"alt",C.o=X),K!==C.i&&Ce(j,"--desktop-cols",C.i=K),C},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),g})()})),D(d=>Ce(p,"--desktop-cols",_())),a})()})()),h})()}ie(["click"]);var bt=S('<div class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"><div class="bg-white rounded-lg shadow-2xl max-w-md w-full p-6"><div class="text-center mb-6"><h2 class="text-3xl font-bold text-gray-900 mb-2">Game Over!</h2></div><div class=mb-6><h3 class="text-lg font-semibold text-gray-700 mb-3">Final Scores</h3><ul class=space-y-2></ul></div><div class="flex gap-3"><button class="flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium">Back to Lobby</button><button class="flex-1 px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 font-medium">Stay Here'),yt=S('<p class="text-xl text-green-600 font-semibold">ðŸŽ‰ <!> wins! ðŸŽ‰'),vt=S('<li><div class="flex items-center gap-3"><span class="text-2xl font-bold text-gray-500"></span><span></span></div><span>');function $t(e){const t=e.players||[],n=e.onClose||(()=>{}),s=()=>[...t].sort((i,l)=>l.score-i.score),o=()=>s()[0],r=()=>{we("/"),n()};return(()=>{var i=bt(),l=i.firstChild,u=l.firstChild;u.firstChild;var c=u.nextSibling,b=c.firstChild,f=b.nextSibling,N=c.nextSibling,w=N.firstChild,L=w.nextSibling;return v(u,(()=>{var $=J(()=>!!o());return()=>$()&&(()=>{var _=yt(),h=_.firstChild,m=h.nextSibling;return m.nextSibling,v(_,()=>o().name,m),_})()})(),null),v(f,G(ve,{get each(){return s()},children:($,_)=>(()=>{var h=vt(),m=h.firstChild,a=m.firstChild,p=a.nextSibling,d=m.nextSibling;return v(a,(()=>{var y=J(()=>_()===0);return()=>y()?"ðŸ¥‡":J(()=>_()===1)()?"ðŸ¥ˆ":J(()=>_()===2)()?"ðŸ¥‰":`${_()+1}.`})()),v(p,()=>$.name),v(d,()=>$.score),D(y=>{var g=`flex items-center justify-between p-3 rounded-lg ${_()===0?"bg-yellow-100 border-2 border-yellow-400":"bg-gray-50 border border-gray-200"}`,x=`font-medium ${_()===0?"text-yellow-900":"text-gray-800"}`,A=`text-2xl font-bold ${_()===0?"text-yellow-600":"text-blue-600"}`;return g!==y.e&&z(h,y.e=g),x!==y.t&&z(p,y.t=x),A!==y.a&&z(d,y.a=A),y},{e:void 0,t:void 0,a:void 0}),h})()})),w.$$click=r,tt(L,"click",n),i})()}ie(["click"]);var xt=S('<div class="h-full flex flex-col"><div class="flex items-center justify-between px-4 py-2 bg-white border-b shadow-sm flex-shrink-0 flex-wrap gap-4"><div class="flex flex-row items-center gap-2 whitespace-nowrap"><button class="px-3 py-1 text-sm bg-gray-200 rounded hover:bg-gray-300">Back to Lobby</button><button class="px-3 py-1 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 flex items-center gap-2"><span></span><span></span></button></div></div><div class="relative flex-1 overflow-hidden"><div class="h-full overflow-auto"></div></div><div><div class="flex items-center justify-between p-4 border-b bg-gray-50"><h3 class="font-semibold text-lg">Chat</h3><button class="text-gray-600 hover:text-gray-900 text-xl font-bold leading-none px-2"type=button>Ã—</button></div><div class="flex-1 overflow-auto p-4"><ul class=space-y-2><div></div></ul></div><div class="p-4 border-t bg-white"><form class="flex flex-col gap-2"><input class="w-full px-3 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500"placeholder="Type a message..."><button type=submit class="w-full px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">Send'),_t=S('<h2 class="text-lg font-semibold whitespace-nowrap">'),wt=S('<div class="flex flex-wrap gap-2 flex-1 justify-center">'),St=S('<div class="flex items-center gap-2 px-2 py-1 bg-gray-50 rounded text-sm"><span class="font-medium text-gray-800"></span><span class="font-bold text-blue-600">'),Ct=S("<li><div class=font-semibold>:</div><div>"),Et=S('<div class="flex gap-1 mt-2 flex-wrap">'),kt=S('<div class="w-16 h-28 p-1 py-2 bg-white rounded-[15px] border border-gray-300 shadow-sm flex justify-center items-center"><img alt="Set card"class=object-contain>');function Nt(e){const[t,n]=k([]),[s,o]=k(!1),[r,i]=k(null),[l,u]=k(!1);let c=null,b;Je(()=>{const a=t();b&&a.length>0&&setTimeout(()=>{b.scrollIntoView({behavior:"smooth",block:"end"})},0)});const f=a=>{const p=["oval","squiggle","diamond"],d=["filled","lines","clear"],y=["red","green","purple"],g=["1","2","3"],x=p[a[0]],A=d[a[1]],j=y[a[2]],C=g[a[3]];return`https://set.gganeles.com/RegCards/${x}_${A}_${j}_${C}.png`};function N(a){try{const p=JSON.parse(a.data);if(p.kind==="init")try{const d=JSON.parse(p.data);if(console.log("Init game data:",d),console.log("Chat history:",d.chat),d.chat&&Array.isArray(d.chat)){const y=d.chat.map(g=>({sender:g.sender,text:g.text,isSystem:g.sender==="System",cards:g.cards||void 0}));console.log("Loading chat messages:",y),n(y)}}catch(d){console.error("Error parsing init:",d)}else if(p.kind==="player_joined")try{const d=JSON.parse(p.data);console.log("Player joined, updated game data:",d),_(d)}catch(d){console.error("Error parsing player_joined:",d)}else if(p.kind==="chat")try{const d=JSON.parse(p.data);d.sender&&d.message?n(y=>[...y,{sender:d.sender,text:d.message}]):n(y=>[...y,{sender:"Unknown",text:p.data}])}catch{n(d=>[...d,{sender:"Player",text:p.data}])}else if(p.kind==="set_found")try{const d=JSON.parse(p.data);if(console.log("Set found data:",d),d.chat&&Array.isArray(d.chat)){const y=d.chat.map(g=>({sender:g.sender,text:g.text,isSystem:g.sender==="System",cards:g.cards||void 0}));n(y)}}catch(d){console.error("Error parsing set_found:",d)}}catch(p){console.error("Error parsing message:",p)}}function w(a){if(c)try{c.close()}catch{}const p=window.location.protocol==="https:"?"wss:":"ws:",d=window.location.hostname||"127.0.0.1",y=`${p}//${d}:3030/game/ws/${a}`;c=new WebSocket(y),c.addEventListener("message",N),c.addEventListener("open",()=>{console.log(`connected to game ${a}`);const g=localStorage.getItem("rs_name")||"Anonymous",x={kind:"join_player",data:JSON.stringify({name:g})};c.send(JSON.stringify(x))}),c.addEventListener("close",()=>console.log("disconnected from game")),c.addEventListener("error",g=>{console.error("WebSocket error:",g)})}w(e.id),ke(()=>{if(c)try{c.close()}catch{}});const[L,$]=k("");function _(a){i(a),a&&a.game_state&&a.game_state.current_state==="game_over"&&u(!0)}function h(a){if(a.preventDefault(),!c||c.readyState!==WebSocket.OPEN)return;const p=L().trim();if(p==="")return;const d=localStorage.getItem("rs_name")||"Anonymous",g={kind:"chat",data:JSON.stringify({sender:d,message:p})};c.send(JSON.stringify(g)),$("")}function m(a){a==null||a.preventDefault(),a==null||a.stopPropagation(),o(!1)}return(()=>{var a=xt(),p=a.firstChild,d=p.firstChild,y=d.firstChild,g=y.nextSibling,x=g.firstChild,A=x.nextSibling,j=p.nextSibling,C=j.firstChild,H=j.nextSibling,W=H.firstChild,F=W.firstChild,X=F.nextSibling,K=W.nextSibling,ae=K.firstChild,te=ae.firstChild,M=K.nextSibling,P=M.firstChild,ce=P.firstChild;v(p,(()=>{var I=J(()=>!!(r()&&r().game_state&&r().game_state.players));return()=>I()&&[(()=>{var B=_t();return v(B,()=>r().game_state.name),B})(),(()=>{var B=wt();return v(B,G(ve,{get each(){return r().game_state.players},children:U=>(()=>{var V=St(),Q=V.firstChild,ne=Q.nextSibling;return v(Q,()=>U.name),v(ne,()=>U.score),V})()})),B})()]})(),d),y.$$click=()=>we("/"),g.$$click=()=>o(!s()),v(x,()=>s()?"Hide Chat":"Show Chat"),v(A,()=>s()?"â†’":"â†"),v(C,G(ht,{socket:c,onGameStateUpdate:_})),X.$$click=m,v(ae,()=>t().map((I,B)=>(()=>{var U=Ct(),V=U.firstChild,Q=V.firstChild,ne=V.nextSibling;return re(U,"key",B),v(V,()=>I.sender,Q),v(ne,()=>I.text),v(U,(()=>{var fe=J(()=>!!(I.cards&&I.cards.length>0));return()=>fe()&&(()=>{var de=Et();return v(de,G(ve,{get each(){return I.cards},children:ue=>(()=>{var ge=kt(),We=ge.firstChild;return D(()=>re(We,"src",f(ue.array))),ge})()})),de})()})(),null),D(()=>z(U,`text-sm p-2 rounded ${I.isSystem?"bg-green-50 border border-green-200":"bg-gray-50 text-gray-800"}`)),U})()),te);var Y=b;return typeof Y=="function"?nt(Y,te):b=te,P.addEventListener("submit",h),ce.$$input=I=>$(I.target.value),v(a,(()=>{var I=J(()=>!!(l()&&r()&&r().game_state&&r().game_state.players));return()=>I()&&G($t,{get players(){return r().game_state.players},onClose:()=>u(!1)})})(),null),D(()=>z(H,`fixed top-0 right-0 h-full w-80 bg-white shadow-2xl border-l transform transition-transform duration-300 flex flex-col z-50 ${s()?"translate-x-0":"translate-x-full"}`)),D(()=>ce.value=L()),a})()}ie(["click","input"]);function Ot(){const e=["oval","squiggle","diamond"],t=["filled","lines","clear"],n=["red","green","purple"],s=["1","2","3"],o="https://set.gganeles.com/RegCards",r=[];for(const i of e)for(const l of t)for(const u of n)for(const c of s){const b=`${o}/${i}_${l}_${u}_${c}.png`,f=new Image;f.src=b,r.push(f)}return console.log(`Preloading ${r.length} card images...`),Promise.allSettled(r.map(i=>new Promise((l,u)=>{i.onload=()=>l(i.src),i.onerror=()=>u(i.src)}))).then(i=>{const l=i.filter(c=>c.status==="fulfilled").length,u=i.filter(c=>c.status==="rejected").length;return console.log(`Card images preloaded: ${l} succeeded, ${u} failed`),{loaded:l,failed:u,total:r.length}})}var At=S('<div class="max-w-[84rem] mx-auto p-[1.5rem] h-screen font-sans">');function Lt(){const[e,t]=k({name:"lobby"}),[n,s]=k(!1);function o(i){if(!i||i==="/"||i==="")return{name:"lobby"};const l=i.split("/").filter(Boolean);return l[0]==="game"&&l[1]?{name:"game",id:l[1]}:{name:"lobby"}}_e(()=>{t(o(window.location.pathname)),window.addEventListener("popstate",()=>t(o(window.location.pathname))),Ot().then(i=>{s(!0),console.log("All card images cached!")}).catch(i=>{console.error("Error preloading images:",i),s(!0)})});function r(i){we(`/game/${i}`)}return(()=>{var i=At();return v(i,(()=>{var l=J(()=>e().name==="lobby");return()=>l()&&G(dt,{onJoin:r})})(),null),v(i,(()=>{var l=J(()=>e().name==="game");return()=>l()&&G(Nt,{get id(){return e().id}})})(),null),i})()}et(()=>G(Lt,{}),document.getElementById("app"));
